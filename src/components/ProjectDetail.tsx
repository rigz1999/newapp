utline-none focus:ring-2 focus:ring-blue-500" /> </div> </div> <div> <label className="block text-sm font-medium text-slate-900 mb-2">Email représentant</label> <input type="email" value={editedProject.email_representant || ''} onChange={(e) => setEditedProject({ ...editedProject, email_representant: e.target.value })} className="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" /> </div> <div> <label className="block text-sm font-medium text-slate-900 mb-2">Représentant de la masse</label> <input type="text" value={editedProject.representant_masse || ''} onChange={(e) => setEditedProject({ ...editedProject, representant_masse: e.target.value })} className="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" /> </div> <div> <label className="block text-sm font-medium text-slate-900 mb-2">Email représentant de la masse</label> <input type="email" value={editedProject.email_rep_masse || ''} onChange={(e) => setEditedProject({ ...editedProject, email_rep_masse: e.target.value })} className="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" /> </div> </div> </div> </div> <div className="flex gap-3 mt-6 pt-6 border-t border-slate-200 sticky bottom-0 bg-white"> <button onClick={() => setShowEditProject(false)} className="flex-1 px-4 py-2 text-sm font-medium border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors" > Annuler </button> <button onClick={handleUpdateProject} className="flex-1 px-4 py-2 text-sm font-medium bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors shadow-sm" > Enregistrer </button> </div> </div> </div> </div> )} {/* Edit Subscription Modal */} {showEditSubscription && editingSubscription && ( <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"> <div className="bg-white rounded-xl shadow-xl max-w-md w-full"> <div className="p-6 border-b border-slate-200"> <div className="flex justify-between items-start"> <div> <h3 className="text-xl font-bold text-slate-900">Modifier la Souscription</h3> <p className="text-sm text-slate-600 mt-1"> {editingSubscription.investisseur.nom_raison_sociale} </p> </div> <button onClick={() => { setShowEditSubscription(false); setEditingSubscription(null); }} className="text-slate-400 hover:text-slate-600" > <X className="w-6 h-6" /> </button> </div> </div> <div className="p-6"> <div className="space-y-4"> <div> <label className="block text-sm font-medium text-slate-900 mb-2"> Date de souscription </label> <input type="date" value={editingSubscription.date_souscription || ''} onChange={(e) => setEditingSubscription({ ...editingSubscription, date_souscription: e.target.value, }) } className="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" /> </div> <div> <label className="block text-sm font-medium text-slate-900 mb-2"> Montant investi (€) </label> <input type="number" step="0.01" value={editingSubscription.montant_investi || ''} onChange={(e) => setEditingSubscription({ ...editingSubscription, montant_investi: parseFloat(e.target.value) || 0, }) } className="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" /> </div> <div> <label className="block text-sm font-medium text-slate-900 mb-2"> Nombre d'obligations </label> <input type="number" value={editingSubscription.nombre_obligations || ''} onChange={(e) => setEditingSubscription({ ...editingSubscription, nombre_obligations: parseInt(e.target.value) || 0, }) } className="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" /> </div> <div className="p-4 bg-slate-50 rounded-lg"> <div className="flex justify-between text-sm"> <span className="text-slate-600">Tranche :</span> <span className="font-medium text-slate-900"> {editingSubscription.tranche.tranche_name} </span> </div> <div className="flex justify-between text-sm mt-2"> <span className="text-slate-600">Coupon net :</span> <span className="font-medium text-slate-900"> {formatCurrency(editingSubscription.coupon_net)} </span> </div> </div> </div> <div className="flex gap-3 mt-6"> <button onClick={() => { setShowEditSubscription(false); setEditingSubscription(null); }} className="flex-1 px-4 py-2 text-sm font-medium border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors" > Annuler </button> <button onClick={handleUpdateSubscription} className="flex-1 px-4 py-2 text-sm font-medium bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors shadow-sm" > Enregistrer </button> </div> </div> </div> </div> )} {/* Payment Wizard Modal */} {showPaymentWizard && ( <PaymentWizard onClose={() => setShowPaymentWizard(false)} onSuccess={() => { setShowPaymentWizard(false); fetchProjectData(); }} /> )} {/* Subscriptions Modal */} {showSubscriptionsModal && ( <SubscriptionsModal subscriptions={subscriptions} onClose={() => setShowSubscriptionsModal(false)} onEdit={(sub) => { setEditingSubscription(sub); setShowEditSubscription(true); }} onDelete={handleDeleteSubscription} formatCurrency={formatCurrency} formatDate={formatDate} /> )} {/* Tranches Modal */} {showTranchesModal && ( <TranchesModal tranches={tranches} subscriptions={subscriptions} onClose={() => setShowTranchesModal(false)} onEdit={(tranche) => { setEditingTranche(tranche); setShowTrancheWizard(true); }} onDelete={handleDeleteTranche} formatCurrency={formatCurrency} formatDate={formatDate} /> )} {/* Echeancier Modal */} {showEcheancierModal && ( <EcheancierModal projectId={projectId!} onClose={() => setShowEcheancierModal(false)} formatCurrency={formatCurrency} formatDate={formatDate} /> )} </div> {/* Alert Modal */} <AlertModal isOpen={alertState.isOpen} onClose={() => setAlertState({ ...alertState, isOpen: false })} onConfirm={alertState.onConfirm} title={alertState.title} message={alertState.message} type={alertState.type} /> </> ); } export default ProjectDetail;